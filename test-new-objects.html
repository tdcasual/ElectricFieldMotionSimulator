<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–°å¯¹è±¡ç±»å‹æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-container {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        h2 {
            color: #333;
            border-bottom: 2px solid #0078d4;
            padding-bottom: 10px;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .test-result.pass {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .test-result.fail {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .code {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ§ª æ–°å¯¹è±¡ç±»å‹é›†æˆæµ‹è¯•</h1>
    
    <div class="test-container">
        <h2>âœ… åŠŸèƒ½æµ‹è¯•</h2>
        <div id="test-results"></div>
    </div>
    
    <div class="test-container">
        <h2>ğŸ“ æµ‹è¯•æ—¥å¿—</h2>
        <div id="test-logs" class="code"></div>
    </div>

    <script type="module">
        const resultsDiv = document.getElementById('test-results');
        const logsDiv = document.getElementById('test-logs');
        
        let testsPassed = 0;
        let testsFailed = 0;
        
        function log(message) {
            logsDiv.innerHTML += message + '<br>';
            console.log(message);
        }
        
        function addResult(name, passed, details = '') {
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${passed ? 'pass' : 'fail'}`;
            resultDiv.innerHTML = `<strong>${passed ? 'âœ…' : 'âŒ'} ${name}</strong>` + 
                                  (details ? `<br><small>${details}</small>` : '');
            resultsDiv.appendChild(resultDiv);
            
            if (passed) testsPassed++;
            else testsFailed++;
        }
        
        async function runTests() {
            log('ğŸ§ª å¼€å§‹æµ‹è¯•...\n');
            
            try {
                // æµ‹è¯•1: å¯¼å…¥SemiCircleElectricField
                log('æµ‹è¯•1: å¯¼å…¥ SemiCircleElectricField');
                const SemiModule = await import('./js/objects/SemiCircleElectricField.js');
                const SemiCircleElectricField = SemiModule.SemiCircleElectricField;
                const semiPassed = SemiCircleElectricField !== undefined;
                addResult('SemiCircleElectricField å¯¼å…¥', semiPassed);
                log(semiPassed ? 'âœ… æˆåŠŸå¯¼å…¥\n' : 'âŒ å¯¼å…¥å¤±è´¥\n');
                
                // æµ‹è¯•2: åˆ›å»ºSemiCircleElectricFieldå®ä¾‹
                log('æµ‹è¯•2: åˆ›å»º SemiCircleElectricField å®ä¾‹');
                const semiField = new SemiCircleElectricField({
                    x: 100,
                    y: 100,
                    radius: 80,
                    strength: 1000,
                    direction: 90,
                    orientation: 0
                });
                const semiCreated = semiField !== null && semiField.type === 'semicircle-electric-field';
                addResult('SemiCircleElectricField å®ä¾‹åŒ–', semiCreated, 
                         `Type: ${semiField.type}`);
                log(semiCreated ? 'âœ… å®ä¾‹åŒ–æˆåŠŸ\n' : 'âŒ å®ä¾‹åŒ–å¤±è´¥\n');
                
                // æµ‹è¯•3: å¯¼å…¥ParallelPlateCapacitor
                log('æµ‹è¯•3: å¯¼å…¥ ParallelPlateCapacitor');
                const CapacitorModule = await import('./js/objects/ParallelPlateCapacitor.js');
                const ParallelPlateCapacitor = CapacitorModule.ParallelPlateCapacitor;
                const capPassed = ParallelPlateCapacitor !== undefined;
                addResult('ParallelPlateCapacitor å¯¼å…¥', capPassed);
                log(capPassed ? 'âœ… æˆåŠŸå¯¼å…¥\n' : 'âŒ å¯¼å…¥å¤±è´¥\n');
                
                // æµ‹è¯•4: åˆ›å»ºParallelPlateCapacitorå®ä¾‹
                log('æµ‹è¯•4: åˆ›å»º ParallelPlateCapacitor å®ä¾‹');
                const capacitor = new ParallelPlateCapacitor({
                    x: 200,
                    y: 200,
                    width: 300,
                    height: 200,
                    plateDistance: 100,
                    strength: 1000,
                    direction: 0,
                    polarity: 1
                });
                const capCreated = capacitor !== null && capacitor.type === 'parallel-plate-capacitor';
                addResult('ParallelPlateCapacitor å®ä¾‹åŒ–', capCreated, 
                         `Type: ${capacitor.type}`);
                log(capCreated ? 'âœ… å®ä¾‹åŒ–æˆåŠŸ\n' : 'âŒ å®ä¾‹åŒ–å¤±è´¥\n');
                
                // æµ‹è¯•5: æµ‹è¯•SemiCircleElectricFieldçš„æ–¹æ³•
                log('æµ‹è¯•5: SemiCircleElectricField æ–¹æ³•æµ‹è¯•');
                const point1Inside = semiField.containsPoint(100, 50); // åœ¨åŠåœ†å†…
                const point2Outside = semiField.containsPoint(100, 250); // åœ¨åŠåœ†å¤–
                const methodsPassed = point1Inside && !point2Outside;
                addResult('SemiCircleElectricField.containsPoint()', methodsPassed);
                log(`containsPoint(100, 50) = ${point1Inside} (åº”ä¸º true)\n`);
                
                // æµ‹è¯•6: æµ‹è¯•ParallelPlateCapacitorçš„æ–¹æ³•
                log('æµ‹è¯•6: ParallelPlateCapacitor æ–¹æ³•æµ‹è¯•');
                const point3Inside = capacitor.containsPoint(200, 200); // åœ¨ç”µå®¹å™¨å†…
                const point4Outside = capacitor.containsPoint(50, 50); // åœ¨ç”µå®¹å™¨å¤–
                const capMethodsPassed = point3Inside && !point4Outside;
                addResult('ParallelPlateCapacitor.containsPoint()', capMethodsPassed);
                log(`containsPoint(200, 200) = ${point3Inside} (åº”ä¸º true)\n`);
                
                // æµ‹è¯•7: åºåˆ—åŒ–æµ‹è¯•
                log('æµ‹è¯•7: åºåˆ—åŒ–æµ‹è¯•');
                const semiSerialized = semiField.serialize();
                const capSerialized = capacitor.serialize();
                const serializePassed = semiSerialized.type === 'semicircle-electric-field' &&
                                       capSerialized.type === 'parallel-plate-capacitor';
                addResult('å¯¹è±¡åºåˆ—åŒ–', serializePassed);
                log(serializePassed ? 'âœ… åºåˆ—åŒ–æˆåŠŸ\n' : 'âŒ åºåˆ—åŒ–å¤±è´¥\n');
                
                // æµ‹è¯•8: DragDropManagerå¯¼å…¥
                log('æµ‹è¯•8: DragDropManager å¯¼å…¥');
                const DragModule = await import('./js/interactions/DragDropManager.js');
                const DragDropManager = DragModule.DragDropManager;
                const dragPassed = DragDropManager !== undefined;
                addResult('DragDropManager å¯¼å…¥', dragPassed);
                log(dragPassed ? 'âœ… æˆåŠŸå¯¼å…¥\n' : 'âŒ å¯¼å…¥å¤±è´¥\n');
                
                // æ€»ç»“
                log('\n' + '='.repeat(50));
                log(`ğŸ“Š æµ‹è¯•å®Œæˆ: ${testsPassed}/${testsPassed + testsFailed} é€šè¿‡`);
                if (testsFailed === 0) {
                    log('ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼æ–°å¯¹è±¡ç±»å‹å·²å‡†å¤‡å°±ç»ªã€‚');
                } else {
                    log(`âš ï¸ æœ‰ ${testsFailed} ä¸ªæµ‹è¯•å¤±è´¥ã€‚`);
                }
                
            } catch (error) {
                log(`âŒ æµ‹è¯•è¿‡ç¨‹ä¸­å‡ºé”™: ${error.message}`);
                addResult('æµ‹è¯•æ‰§è¡Œ', false, error.message);
            }
        }
        
        // è¿è¡Œæµ‹è¯•
        runTests();
    </script>
</body>
</html>
