<script setup lang="ts">
import { onBeforeUnmount } from 'vue';
import { createSwipeCloseGesture } from '../utils/swipeCloseGesture';

const emit = defineEmits<{
  (event: 'close'): void;
  (event: 'export-scene'): void;
  (event: 'open-import'): void;
  (event: 'toggle-theme'): void;
  (event: 'save-scene'): void;
  (event: 'load-scene'): void;
  (event: 'clear-scene'): void;
  (event: 'open-variables'): void;
  (event: 'toggle-markdown'): void;
}>();

const swipeGesture = createSwipeCloseGesture(() => {
  emit('close');
});

onBeforeUnmount(() => {
  swipeGesture.dispose();
});
</script>

<template>
  <section class="phone-sheet phone-more-sheet" data-testid="phone-more-sheet" aria-label="æ›´å¤šæ“ä½œé¢æ¿">
    <div
      class="phone-sheet-header"
      @pointerdown="swipeGesture.onPointerDown"
      @pointerup="swipeGesture.onPointerUp"
      @pointercancel="swipeGesture.onPointerCancel"
    >
      <h3>æ›´å¤šæ“ä½œ</h3>
      <button type="button" class="btn-icon" aria-label="å…³é—­æ›´å¤šæ“ä½œé¢æ¿" @click="emit('close')">âœ–</button>
    </div>
    <div class="phone-sheet-body phone-more-body">
      <section class="phone-more-section" aria-label="åœºæ™¯æ–‡ä»¶">
        <p class="phone-more-section-title">åœºæ™¯æ–‡ä»¶</p>
        <div class="phone-more-grid">
          <button id="secondary-save-btn" class="btn btn-primary" type="button" @click="emit('save-scene')">ğŸ’¾ ä¿å­˜åœºæ™¯</button>
          <button id="secondary-load-btn" class="btn" type="button" @click="emit('load-scene')">ğŸ“‚ è¯»å–åœºæ™¯</button>
          <button id="secondary-export-btn" class="btn" type="button" @click="emit('export-scene')">ğŸ“¤ å¯¼å‡ºåœºæ™¯</button>
          <button id="secondary-import-btn" class="btn" type="button" @click="emit('open-import')">ğŸ“¥ å¯¼å…¥åœºæ™¯</button>
          <button id="secondary-clear-btn" class="btn object-action-danger phone-more-danger" type="button" @click="emit('clear-scene')">ğŸ—‘ æ¸…ç©ºåœºæ™¯</button>
        </div>
      </section>
      <section class="phone-more-section" aria-label="ç•Œé¢å·¥å…·">
        <p class="phone-more-section-title">ç•Œé¢å·¥å…·</p>
        <div class="phone-more-grid">
          <button id="secondary-variables-btn" class="btn" type="button" @click="emit('open-variables')">Æ’x å˜é‡è¡¨</button>
          <button id="secondary-markdown-btn" class="btn" type="button" @click="emit('toggle-markdown')">ğŸ“ é¢˜æ¿</button>
          <button id="secondary-theme-btn" class="btn" type="button" @click="emit('toggle-theme')">ğŸŒ™ åˆ‡æ¢ä¸»é¢˜</button>
        </div>
      </section>
    </div>
  </section>
</template>
