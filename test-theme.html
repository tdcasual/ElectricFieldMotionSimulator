<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸»é¢˜åˆ‡æ¢æµ‹è¯•</title>
    <link rel="stylesheet" href="styles/theme.css">
    <link rel="stylesheet" href="styles/main.css">
    <link rel="stylesheet" href="styles/components.css">
    <style>
        body {
            padding: 20px;
        }
        .test-section {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid var(--border-color);
            border-radius: var(--radius-md);
            background: var(--bg-secondary);
        }
        .color-swatch {
            display: inline-block;
            width: 40px;
            height: 40px;
            margin: 10px;
            border-radius: var(--radius-sm);
            border: 1px solid var(--border-color);
        }
        canvas {
            border: 1px solid var(--border-color);
            background: var(--bg-primary);
            margin: 10px 0;
        }
    </style>
</head>
<body class="dark-theme">
    <h1>ğŸ¨ ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½æµ‹è¯•</h1>
    
    <button id="theme-btn" class="btn btn-primary" style="margin-bottom: 20px;">
        åˆ‡æ¢ä¸»é¢˜ (å½“å‰: æ·±è‰² ğŸŒ™)
    </button>
    
    <div class="test-section">
        <h2>å½“å‰ä¸»é¢˜ä¿¡æ¯</h2>
        <p>ä¸»é¢˜: <strong id="theme-info">æ·±è‰²</strong></p>
        <p>HTML data-theme: <strong id="html-theme">dark</strong></p>
        <p>Body classes: <strong id="body-classes">dark-theme</strong></p>
    </div>
    
    <div class="test-section">
        <h2>é¢œè‰²å˜é‡æµ‹è¯•</h2>
        <div>
            <label>--bg-primary: </label>
            <div class="color-swatch" id="color-bg-primary"></div>
            <code id="code-bg-primary">#1e1e1e</code>
        </div>
        <div>
            <label>--text-primary: </label>
            <div class="color-swatch" id="color-text-primary"></div>
            <code id="code-text-primary">#cccccc</code>
        </div>
        <div>
            <label>--accent-blue: </label>
            <div class="color-swatch" id="color-accent-blue"></div>
            <code id="code-accent-blue">#0e639c</code>
        </div>
        <div>
            <label>--electric-field-color: </label>
            <div class="color-swatch" id="color-electric-field"></div>
            <code id="code-electric-field">rgba(255, 200, 0, 0.3)</code>
        </div>
    </div>
    
    <div class="test-section">
        <h2>Canvasç½‘æ ¼æµ‹è¯•</h2>
        <canvas id="grid-canvas" width="400" height="200"></canvas>
    </div>
    
    <div class="test-section">
        <h2>Canvasç®­å¤´æµ‹è¯•</h2>
        <canvas id="arrow-canvas" width="400" height="200"></canvas>
    </div>

    <script type="module">
        import { ThemeManager } from './js/utils/ThemeManager.js';
        
        const themeManager = new ThemeManager();
        const themeBtn = document.getElementById('theme-btn');
        
        // æ›´æ–°æ˜¾ç¤º
        function updateDisplay() {
            const theme = themeManager.getCurrentTheme();
            const isDark = theme === 'dark';
            
            document.getElementById('theme-info').textContent = isDark ? 'æ·±è‰²' : 'æµ…è‰²';
            document.getElementById('html-theme').textContent = theme;
            document.getElementById('body-classes').textContent = document.body.className;
            document.getElementById('theme-btn').textContent = 
                `åˆ‡æ¢ä¸»é¢˜ (å½“å‰: ${isDark ? 'æ·±è‰² ğŸŒ™' : 'æµ…è‰² â˜€ï¸'})`;
            
            // æ›´æ–°é¢œè‰²å˜é‡æ˜¾ç¤º
            const style = getComputedStyle(document.documentElement);
            const colors = {
                'bg-primary': '--bg-primary',
                'text-primary': '--text-primary',
                'accent-blue': '--accent-blue',
                'electric-field': '--electric-field-color'
            };
            
            for (const [id, varName] of Object.entries(colors)) {
                const value = style.getPropertyValue(varName).trim();
                const swatch = document.getElementById(`color-${id}`);
                const code = document.getElementById(`code-${id}`);
                swatch.style.backgroundColor = value;
                code.textContent = value;
            }
            
            // é‡æ–°ç»˜åˆ¶Canvas
            drawGridCanvas();
            drawArrowCanvas();
        }
        
        // ç»˜åˆ¶ç½‘æ ¼Canvas
        function drawGridCanvas() {
            const canvas = document.getElementById('grid-canvas');
            const ctx = canvas.getContext('2d');
            const isDarkTheme = document.body.classList.contains('dark-theme');
            
            // æ¸…ç©ºèƒŒæ™¯
            ctx.fillStyle = isDarkTheme ? '#1e1e1e' : '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶ç½‘æ ¼
            ctx.strokeStyle = isDarkTheme ? 'rgba(51, 51, 51, 0.5)' : 'rgba(200, 200, 200, 0.5)';
            ctx.lineWidth = 0.5;
            const gridSize = 20;
            
            for (let x = 0; x <= canvas.width; x += gridSize) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, canvas.height);
                ctx.stroke();
            }
            
            for (let y = 0; y <= canvas.height; y += gridSize) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(canvas.width, y);
                ctx.stroke();
            }
        }
        
        // ç»˜åˆ¶ç®­å¤´Canvas
        function drawArrowCanvas() {
            const canvas = document.getElementById('arrow-canvas');
            const ctx = canvas.getContext('2d');
            const isDarkTheme = document.body.classList.contains('dark-theme');
            
            // æ¸…ç©ºèƒŒæ™¯
            ctx.fillStyle = isDarkTheme ? '#1e1e1e' : '#ffffff';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // ç»˜åˆ¶ç”µåœºç®­å¤´
            const color = isDarkTheme ? 'rgba(255, 200, 0, 0.6)' : 'rgba(255, 150, 0, 0.7)';
            ctx.strokeStyle = color;
            ctx.fillStyle = color;
            ctx.lineWidth = 2;
            
            const x = 100, y = 100;
            const dx = 80, dy = 0;
            
            ctx.beginPath();
            ctx.moveTo(x, y);
            ctx.lineTo(x + dx, y + dy);
            ctx.stroke();
            
            const angle = Math.atan2(dy, dx);
            const headLen = 8;
            
            ctx.beginPath();
            ctx.moveTo(x + dx, y + dy);
            ctx.lineTo(
                x + dx - headLen * Math.cos(angle - Math.PI / 6),
                y + dy - headLen * Math.sin(angle - Math.PI / 6)
            );
            ctx.lineTo(
                x + dx - headLen * Math.cos(angle + Math.PI / 6),
                y + dy - headLen * Math.sin(angle + Math.PI / 6)
            );
            ctx.closePath();
            ctx.fill();
            
            // ç»˜åˆ¶ç£åœºç‚¹
            const magColor = isDarkTheme ? 'rgba(100, 150, 255, 0.6)' : 'rgba(100, 150, 255, 0.7)';
            ctx.fillStyle = magColor;
            ctx.beginPath();
            ctx.arc(300, 100, 6, 0, Math.PI * 2);
            ctx.fill();
        }
        
        // äº‹ä»¶ç›‘å¬
        themeBtn.addEventListener('click', () => {
            themeManager.toggle();
            updateDisplay();
        });
        
        // åˆå§‹æ˜¾ç¤º
        updateDisplay();
    </script>
</body>
</html>
